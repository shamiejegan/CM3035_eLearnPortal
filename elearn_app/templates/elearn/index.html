{% extends './base/base.html' %}
{% load django_bootstrap5 %}

{% block content %}

{% include './base/navigation-home.html' %}
<div class="row">
    <div class="col-9">
        <div class="page-section profile-section">
            <div class="heading-with-button">
                <h2>About Me</h2>
                <a class="btn-yellow" href="/updateprofile/">Update Profile</a>
            </div>

            <div class="profile">
                {% if user_profile.photo %}
                <img src="{{user_profile.photo.url }}" alt="Profile Picture">
                {% else %}
                <img src="../../static/images/default_user.png" alt="Profile Picture">
                {% endif %}
                <div class="profile-info">
                    <p><strong>Full Name: </strong>{{user.first_name}} {{user.last_name}}</p>
                    <p><strong>Email Address: </strong><a class="link-on-black"
                            href="mailto:{{user.email}}">{{user.email}}</a></p>
                        <p><strong>Status: </strong>
                            <span class="status-icon {% if user.is_active %}status-active{% else %}status-deactivated{% endif %}"></span>
                            <em>{% if user_profile.status %}{{user_profile.status}}{% else %}-{% endif %}</em>
                        </p>
                        <br>
                </div>
            </div>

        </div>
        <div class="page-section">
            {% if user_profile.is_student %}
            <div class="heading-with-button">
                <h2>Enrolled Courses</h2>
                <a class="btn-yellow" href="/">Add Course</a>
            </div>
                {% if courses_enrolled %}
                <table class="table">
                    <th>Module Code</th>
                    <th>Title</th>
                    <th>Instructor</th>
                    {% for enrolled in courses_enrolled %}
                    <tr> 
                        <td><a href="/course/{{enrolled.id}}">{{ enrolled.module_code }}</a></td>
                        <td>{{ enrolled.title }}</td>
                        <td><a href="/profile/{{enrolled.instructor.id}}">{{ enrolled.instructor.user.get_full_name }}</a></td>
                    </tr>
                    {% endfor %}
                {% else %}
                <p>You have not registered for any courses. You will see your courses here once you have been registered.</p>
                {% endif %}
            {% endif %}
            {% if user_profile.is_instructor %}
            <div class="heading-with-button">
                <h2>My Courses</h2>
                <a class="btn-yellow" href="newcourse">Add Course</a>
            </div>
                {% if courses_taught %}
                <table class="table">
                    <th>Module Code</th>
                    <th>Title</th>
                    <th>Students Enrolled</th>
                    {% for taught in courses_taught %}
                    <tr>
                        <td><a href="/course/{{taught.id}}">{{ taught.module_code }}</a></td>
                        <td>{{ taught.title }}</td>
                        <td>
                            <ol>
                                {% for student in taught.students.all %}
                                <li><a href="/profile/{{student.user.id}}">{{student.user.get_full_name}}</a></li>
                                {% endfor %}
                            </ol>
                        </td>
                        <td>
                            <ul>
                                {% for deadline in taught.deadlines %}
                                <li>{{ deadline }}</li>
                                {% endfor %}
                            </ul>
                        </td>
                    </tr>
                    {% endfor %}
                    {% else %}
                    <p>You have not created any courses. You will see your courses here once you have created a course.
                    </p>
                    {% endif %}
                    {% endif %}
                </table>
        </div>

    </div>
    <div class="col-3">
        <div class="page-section side-section">
            <h2>Notifications</h2>
        </div>
    </div>
</div>
{% endblock %}